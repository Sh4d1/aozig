name: CI
on:
  push:
    branches: [ "main" ]
jobs:
  build:
    runs-on: [self-hosted, linux, RISCV64]
    steps:
      - name: Clone the repo
        run: git clone https://github.com/Sh4d1/aozig.git || git -C aozig pull origin
          
      - name: Install zig
        run: mkdir zig && mkdir -p bin && curl -fsSL https://ziglang.org/builds/zig-linux-riscv64-0.12.0-dev.2341+92211135f.tar.xz -o /tmp/zig.tar.xz && tar xf /tmp/zig.tar.xz -C /tmp && cp /tmp/zig-linux-riscv64-0.12.0-dev.2341+92211135f/zig /usr/bin/zig || true

      - name: Bench
        run: cd aozig ; zig build run -- bench
      
